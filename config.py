import pandas as pd
import pymysql

host, user, passwd, db = ('ht-polardb.rwlb.rds.aliyuncs.com',
                          'user_bi',
                          'H^4zzM8iVc&c',
                          'dw_bi')

stores = {
    15: '天鹅湾',
    17: '天溢',
    18: '金海湾',
    19: '荔湾',
    20: '侨香',
    21: '南山',
    22: '坂田',
    23: '宝体',
    24: '翠竹',
    25: '新洲',
    26: '横岗',
    29: '七宝',
    30: '世纪',
    31: '中环',
    32: '五角场',
    34: '共康',
    35: '南方',
    36: '卢湾',
    37: '古美',
    38: '大华',
    39: '大宁',
    40: '嘉定大融城',
    41: '天山',
    42: '宝地',
    43: '富荟',
    44: '富都',
    45: '川沙',
    46: '徐汇',
    47: '日月光',
    48: '松江',
    49: '漕宝日月光',
    50: '莘庄',
    51: '豫园',
    52: '金桥',
    53: '金汇',
    54: '长寿路',
    55: '中原',
    58: '临汾五洲',
    61: '上海储备',
    62: '广州储备',
    63: '深圳储备',
    65: '娄底碧桂园',
    70: '中福',
    72: '西乡',
    73: '天河北',
    74: '通州万达',
    75: '新邻',
    81: '朝阳北苑',
    83: '御上海',
    84: '渔人码头',
    86: '江南西',
    87: '梅林',
    91: '熙南里',
    92: '太阳城',
    93: '南翔',
    94: '静安大融城',
    99: '红山',
    103: '丰台方庄',
    106: '亿丰',
    107: '北新泾',
    109: '控江',
    113: '华漕',
    114: '七宝易养',
    115: '太阳城易养',
    117: '天鹅湾易养',
    119: '梅林易养',
    122: '亚运村',
    123: '佛山普君',
    128: '国泰',
    140: '星宝',
    141: '青浦',
    143: '金沙湖',
    144: '厚仁',
    145: '太阳宫',
    146: '蛇口',
    147: '石芽岭',
    151: '国学测试',
    152: '雨花书院',
    153: '森林书屋',
    155: '商务部',
    156: '好研社',
    157: '伯乐/山长',
    158: '观澜',
    159: '颛桥',
    160: '大唐',
    162: '北京储备',
    164: '陆家浜',
    165: '金沙和美',
    166: '贵阳甲秀',
    167: '线上馆',
    168: '黄龙',
    169: '凤起',
    170: '西溪',
    171: '中大',
    172: '西湖',
    173: '金地',
    174: '滨江',
    175: '余之城',
    177: '福田百花',
    178: '高鑫',
    179: '印象城',
    180: '杭州储备',
    181: '宁波储备',
    182: '合肥储备',
    183: '佛山储备',
    184: '南京储备',
    185: '娄底储备',
    186: '临汾储备',
    187: '成都汇锦城',
    188: '太原学府馆',
    189: '长沙梅溪湖',
    190: '国学测试2馆',
    191: '金源',
    192: '华侨城',
    193: '河西万达',
    194: '国学测试三馆',
    195: '临汾三中学苑',
    196: '长治财苑',
    197: '珠江新城',
    198: '东风东',
    199: '大拇指',
    200: '言居易金源馆',
    201: '广安门',
    202: '南桥',
    203: '福州长乐',
    204: '疁城新天地',
    205: '长沙洋湖',
    206: '体验测试分馆',
    207: '曲阳百联',
    208: '中山公园',
    209: '623测试分馆',
    210: '南昌红谷滩',
    211: '环宇城',
    212: '萧山万象汇',
    213: '虹口赤峰',
    216: '太原万象城',
    218: '梅川',
    219: '丰益',
    220: '和平里',
    221: '重庆中央公园',
    222: '成都金沙',
    223: '武汉徐东',
    224: '嘉兴南湖',
    226: '重庆爱加',
    229: '东莞南城',
    232: '翠微印象城',
    233: '重庆金辉',
    234: '悦方',
    235: '福州欢乐颂',
    236: '重庆沙坪坝',
    256: '东莞东城',
    259: '武汉江宸天街',
    260: '悦汇城',
    261: '大宁音乐广场',
    262: '南宁盛天地',
    263: '嘉兴八佰伴',
    264: '高新银泰',
    265: '成都金牛',
    267: '重庆陆海国际',
    268: '重庆江北嘴',
    269: '重庆协信星光',
    270: '狮山龙湖',
    271: '南通印象城',
    272: '在线管理中心',
    273: '在线围棋',
    274: '湖州爱山广场',
    275: '福州东百中心',
    276: '天津大悦城',
    277: '沈阳K11'
}


def conn():
    return pymysql.connect(user=user, host=host, port=3306, passwd=passwd, db=db, charset='utf8')


def get_store_name(num):
    if num in stores:
        store_name = stores[num]
        return store_name
    else:
        return "Store not found"


if __name__ == '__main__':
    conn = conn()
    cursor = conn.cursor()
    sql_query = """
    select * from tmp_dm_student_status where stu_lesson_type_two <>2 order by stu_id
    """
    data = pd.read_sql_query(sql_query, conn)
    conn.close()
    print(data.head(10))
    get_store_name(29)
